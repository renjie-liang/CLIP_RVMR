import matplotlib.pyplot as plt
import numpy as np


# segment recall  = {10: 0.09211223889144472, 20: 0.1554199335921889, 30: 0.2089991133139293, 40: 0.253499235096455, 50: 0.2919042307014721, 60: 0.3254121311288225, 70: 0.35284153462112977, 80: 0.37785099160805985, 90: 0.4016631135397701, 100: 0.42312471455180395, 200: 0.5575700406464552, 300: 0.6304896407898284, 400: 0.6759137123387767, 500: 0.7101173894875241, 600: 0.7354368550400634, 700: 0.7548886964025192, 800: 0.7724177095464355, 900: 0.7859319499319882, 1000: 0.797066435118975}
# video_recall = {10: 0.15525448332437497, 20: 0.24509541235771884, 30: 0.31218750374400533, 40: 0.3678879219019312, 50: 0.4135774707429506, 60: 0.452023234192584, 70: 0.4830595651659893, 80: 0.5085640619355789, 90: 0.5328184295274079, 100: 0.5535912811843927, 200: 0.6785440392762374, 300: 0.7433657701555535, 400: 0.7824260123849908, 500: 0.8131537833822664, 600: 0.8345928829554217, 700: 0.8506347719100041, 800: 0.8647626153583584, 900: 0.8734922697380127, 1000: 0.8823847525910219}
# uvideo_number = {10: 7.042, 20: 13.35, 30: 19.384, 40: 25.394, 50: 31.43, 60: 37.262, 70: 43.156, 80: 48.904, 90: 54.734, 100: 60.614, 200: 118.248, 300: 175.73, 400: 232.536, 500: 289.16, 600: 345.3, 700: 400.958, 800: 456.338, 900: 511.766, 1000: 566.706}


ground_truht_recall_by_segment = {10: 0.14955683222580807, 20: 0.23693408599092633, 30: 0.3010426891771826, 40: 0.3527572369125121, 50: 0.3961607922122791, 60: 0.4322304647260427, 70: 0.4637974167561573, 80: 0.4903805392580927, 90: 0.5158977891298051, 100: 0.5380065998372576, 200: 0.6690985577551529, 300: 0.7336642065935368, 400: 0.7750408826920204, 500: 0.8024706227072169, 600: 0.8222594900069692, 700: 0.8373765053433668, 800: 0.8497078327927055, 900: 0.8596764476384213, 1000: 0.8682158050706835}                                                                                                                                                                  
ground_truht_recall_by_video = {10: 0.15951368130265944, 20: 0.24970969145272928, 30: 0.31606547716358196, 40: 0.3693707033537921, 50: 0.4135579708547862, 60: 0.4501398274864263, 70: 0.4818981388455986, 80: 0.5085808010409278, 90: 0.5340582258688708, 100: 0.5560587459901187, 200: 0.6868711139802781, 300: 0.7507875064284708, 400: 0.7914684765152586, 500: 0.8183933010661055, 600: 0.838095625851826, 700: 0.8531645442201544, 800: 0.8654679494272387, 900: 0.87521525800072, 1000: 0.8835513483123566}
unique_video_number = {10: 7.1021215390147425, 20: 13.408126573175117, 30: 19.487594390507013, 40: 25.508450197770586, 50: 31.44947860481841, 60: 37.34124415677814, 70: 43.202085580726354, 80: 48.99101042790363, 90: 54.82596188421431, 100: 60.603380079108234, 200: 118.16540812657317, 300: 175.55591513843942, 400: 232.8475368572456, 500: 289.7353469974829, 600: 346.378640776699, 700: 402.9564904710536, 800: 459.35526788924847, 900: 515.3045667026249, 1000: 571.0}                                
prediction_recall_by_seg = {10: 0.09327559965058521, 20: 0.15825530898570012, 30: 0.2108447225922915, 40: 0.2548230296021255, 50: 0.2926743979816724, 60: 0.3254739755970335, 70: 0.3544148286681333, 80: 0.38035455571174054, 90: 0.4047182025102513, 100: 0.4266065093147627, 200: 0.5653309939158988, 300: 0.6384479104393629, 400: 0.6866550799211184, 500: 0.7201952050869078, 600: 0.7452514796676731, 700: 0.764752014825035, 800: 0.7810048318147097, 900: 0.7942298536843255, 1000: 0.8052793892719183} 

K = 10
top_k = [10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000]
# top_k = [10, 20, 30, 40, 50, 60, 70, 80, 90, 100]
gt_recall_vid = [ground_truht_recall_by_video[i]*100 for i in top_k]
gt_recall_seg = [ground_truht_recall_by_segment[i]*100 for i in top_k]
unique_video_number = [unique_video_number[i] for i in top_k]

fig1, ax1 = plt.subplots(figsize=(8, 6))
fig1.subplots_adjust(left=0.1, right=0.9, top=0.9, bottom=0.0)

color = 'tab:blue'
ax1.set_xlabel('top K segment')
ax1.set_ylabel('Unique video number', color=color)
ax1.bar(top_k, unique_video_number, color=color, width=6, alpha=0.8, label='Unique Video Number')
ax1.tick_params(axis='y', labelcolor=color)

ax2 = ax1.twinx()
color = 'tab:red'
ax2.set_ylabel('Recall (%)', color=color)
ax2.plot(top_k, gt_recall_vid, marker='o', linestyle='-', color=color, label='Ground Truth Recall by Video (%)')
ax2.tick_params(axis='y', labelcolor=color)

ax2.plot(top_k, gt_recall_seg, marker='*', linestyle='--', color=color, label='Ground Truth Recall by Segment (%)')
ax1.set_title('Test set: Top K segment & Unique video number, Ground truth recall')

handles1, labels1 = ax1.get_legend_handles_labels()
handles2, labels2 = ax2.get_legend_handles_labels()
handles = handles1 + handles2
labels = labels1 + labels2

fig1.legend(handles, labels, loc='upper center', bbox_to_anchor=(0.5, -0.1), ncol=2)

fig1.savefig("top10_1000.png", bbox_inches='tight', dpi=600)


